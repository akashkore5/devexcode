---
id: "878164"
title: "Magic Square"
slug: "magic-square"
difficulty: "Medium"
companyTags: []
tags: ["Arrays", "Matrix"]
---

**Magic Square**
================

**Slug:** magic-square
**Difficulty:** Medium
**Id:** 878164
**Topic Tags:** Arrays, Matrix
**Company Tags:** None

## Summary
The Magic Square problem involves creating a square matrix with distinct integers from 1 to n^2, such that each row, column, and diagonal sum up to the same value. This is an optimization problem that requires careful planning and execution.

## Detailed Explanation
To solve this problem, we can start by initializing a 2D array of size n x n. Then, we fill in the array with numbers from 1 to n^2 such that each row, column, and diagonal sum up to the same value. We use a simple algorithm to achieve this.

Here's the step-by-step breakdown:

1. Initialize an empty 2D array `arr` of size `n x n`.
2. Calculate the magic constant `m = (n * (n^2 + 1)) / 2`. This is the sum that each row, column, and diagonal should have.
3. Fill in the array with numbers from 1 to `n^2`. Start by filling the first row, then move diagonally towards the bottom-right corner, and finally fill in the remaining cells.
4. In each cell, calculate the sum of the current row, column, and diagonal. If this sum is equal to `m`, set the value of the cell to 1; otherwise, increment the value by 1.

Here's an ASCII art diagram illustrating the filling process:

```
  1 | 2 | 3
  ---------
 4 | 5 | 6
  ---------
 7 | 8 | 9
```

Time complexity: O(n^2) as we fill in the entire array.
Space complexity: O(n^2) for storing the 2D array.

## Optimized Solutions

### Java
```java
public class MagicSquare {
    public static void main(String[] args) {
        int n = 3; // Example size
        int[][] arr = new int[n][n];
        int m = (n * (n * n + 1)) / 2;
        
        for (int i = 0; i < n; i++) {
            for (int j = 0; j < n; j++) {
                arr[i][j] = fill(arr, i, j, m);
            }
        }
    }
    
    public static int fill(int[][] arr, int i, int j, int m) {
        if (i == j && i == (arr.length - 1) / 2) { // Bottom-right corner
            return 1;
        }
        
        for (int k = 1; ; k++) {
            if (k + i >= arr.length || k + j >= arr[0].length || arr[i][j] != 0) {
                break;
            }
            arr[i][j] = k;
            m -= k;
            if (m == 0) {
                return k;
            }
        }
        
        return -1; // Error: Couldn't find a valid value
    }
}
```

### Python
```python
class MagicSquare:
    def __init__(self, n):
        self.n = n
        self.arr = [[0] * n for _ in range(n)]
        self.m = (n * (n ** 2 + 1)) // 2
    
    def fill(self, i, j):
        if i == j and i == (self.n - 1) // 2:  # Bottom-right corner
            return 1
        
        for k in range(1, self.n ** 2 + 1):
            if k + i >= self.n or k + j >= self.arr[0].length or self.arr[i][j] != 0:
                break
            self.arr[i][j] = k
            self.m -= k
            if self.m == 0:
                return k
        
        return -1  # Error: Couldn't find a valid value

    def generate_magic_square(self):
        for i in range(self.n):
            for j in range(self.n):
                self.fill(i, j)
```

### C++
```cpp
#include <iostream>
using namespace std;

class MagicSquare {
public:
    MagicSquare(int n) : n(n), arr(new int*[n]), m((n * (n * n + 1)) / 2) {
        for (int i = 0; i < n; i++) {
            arr[i] = new int[n];
        }
        
        fill(0, 0);
    }
    
    ~MagicSquare() {
        for (int i = 0; i < n; i++) {
            delete[] arr[i];
        }
        delete[] arr;
    }
    
    void fill(int i, int j) {
        if (i == j && i == (n - 1) / 2) { // Bottom-right corner
            return;
        }
        
        for (int k = 1; ; k++) {
            if (k + i >= n || k + j >= arr[0].length || arr[i][j] != 0) {
                break;
            }
            arr[i][j] = k;
            m -= k;
            if (m == 0) {
                return;
            }
        }
        
        cout << "Error: Couldn't find a valid value" << endl;
    }
    
    void print() {
        for (int i = 0; i < n; i++) {
            for (int j = 0; j < n; j++) {
                cout << arr[i][j] << " ";
            }
            cout << endl;
        }
    }

private:
    int n;
    int** arr;
    int m;
};

int main() {
    MagicSquare ms(3);
    ms.print();
    return 0;
}
```

### JavaScript
```javascript
class MagicSquare {
  constructor(n) {
    this.n = n;
    this.arr = Array.from({ length: n }, () => new Array(n).fill(0));
    this.m = (n * (n ** 2 + 1)) / 2;
  }
  
  fill(i, j) {
    if (i === j && i === Math.floor((this.n - 1) / 2)) { // Bottom-right corner
      return;
    }
    
    for (let k = 1; ; k++) {
      if (k + i >= this.n || k + j >= this.arr[0].length || this.arr[i][j] !== 0) {
        break;
      }
      this.arr[i][j] = k;
      this.m -= k;
      if (this.m === 0) {
        return;
      }
    }
    
    console.log("Error: Couldn't find a valid value");
  }
  
  generateMagicSquare() {
    for (let i = 0; i < this.n; i++) {
      for (let j = 0; j < this.n; j++) {
        this.fill(i, j);
      }
    }
  }
}

const ms = new MagicSquare(3);
ms.generateMagicSquare();
```