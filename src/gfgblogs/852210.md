---
id: "852210"
title: "Sort last M elements"
slug: "sort-last-m-elements--155156"
difficulty: "Medium"
companyTags: ["Microsoft"]
tags: ["Sorting", "Merge Sort", "Algorithms"]
---

Here is the detailed Markdown blog post for the problem:

**Sort last M elements**
=====================

### Summary
The problem requires sorting the last `M` elements of an array in ascending order, given a pre-existing sorted array. This problem involves concepts from Sorting and Merge Sort.

## Detailed Explanation
Sorting the last `M` elements of an array is a subproblem that can be solved by merging the last `M` elements of two arrays in ascending order. To solve this problem, we will use the merge part of the Merge Sort algorithm.

Here's a step-by-step breakdown of the solution:

1. Create two temporary arrays: `leftArr` and `rightArr`. The size of `leftArr` is `n - M`, where `n` is the size of the original array.
2. Copy the first `n - M` elements to `leftArr`.
3. Copy the last `M` elements to `rightArr`.
4. Merge `leftArr` and `rightArr` in ascending order using the merge part of the Merge Sort algorithm.

The time complexity for this solution is O(M log M) as we are performing a merge operation on an array of size `M`. The space complexity is O(M), as we need to create two temporary arrays of size `M`.

## Optimized Solutions
Here are optimized solutions in various programming languages:

### Java
```java
public static void sortLastMElements(int[] arr, int M) {
    if (arr.length <= M) {
        Arrays.sort(arr);
        return;
    }

    int[] leftArr = new int[arr.length - M];
    System.arraycopy(arr, 0, leftArr, 0, arr.length - M);

    int[] rightArr = new int[M];
    System.arraycopy(arr, arr.length - M, rightArr, 0, M);

    int i = 0;
    int j = 0;
    for (int k = 0; k < arr.length; k++) {
        if (i < leftArr.length && j < rightArr.length) {
            if (leftArr[i] <= rightArr[j]) {
                arr[k] = leftArr[i];
                i++;
            } else {
                arr[k] = rightArr[j];
                j++;
            }
        } else if (i < leftArr.length) {
            arr[k] = leftArr[i];
            i++;
        } else {
            arr[k] = rightArr[j];
            j++;
        }
    }
}
```

### Python
```python
def sort_last_m_elements(arr, M):
    if len(arr) <= M:
        return sorted(arr)

    left_arr = arr[:len(arr) - M]
    right_arr = arr[-M:]

    i = 0
    j = 0
    result = []
    while i < len(left_arr) and j < len(right_arr):
        if left_arr[i] <= right_arr[j]:
            result.append(left_arr[i])
            i += 1
        else:
            result.append(right_arr[j])
            j += 1

    result.extend(left_arr[i:])
    result.extend(right_arr[j:])

    return result
```

### C++
```cpp
void sortLastMElements(int arr[], int n, int M) {
    if (n <= M) {
        std::sort(arr, arr + n);
        return;
    }

    int* leftArr = new int[n - M];
    for (int i = 0; i < n - M; i++) {
        leftArr[i] = arr[i];
    }

    int* rightArr = new int[M];
    for (int i = 0; i < M; i++) {
        rightArr[i] = arr[n - M + i];
    }

    int i = 0;
    int j = 0;
    for (int k = 0; k < n; k++) {
        if (i < n - M && j < M) {
            if (leftArr[i] <= rightArr[j]) {
                arr[k] = leftArr[i];
                i++;
            } else {
                arr[k] = rightArr[j];
                j++;
            }
        } else if (i < n - M) {
            arr[k] = leftArr[i];
            i++;
        } else {
            arr[k] = rightArr[j];
            j++;
        }
    }

    delete[] leftArr;
    delete[] rightArr;
}
```

### JavaScript
```javascript
function sortLastMElements(arr, M) {
  if (arr.length <= M) {
    return arr.slice().sort((a, b) => a - b);
  }

  const leftArr = arr.slice(0, arr.length - M);
  const rightArr = arr.slice(arr.length - M);

  let i = 0;
  let j = 0;
  const result = [];
  while (i < leftArr.length && j < rightArr.length) {
    if (leftArr[i] <= rightArr[j]) {
      result.push(leftArr[i]);
      i++;
    } else {
      result.push(rightArr[j]);
      j++;
    }
  }

  result.push(...leftArr.slice(i));
  result.push(...rightArr.slice(j));

  return result;
}
```