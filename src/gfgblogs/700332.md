---
id: "700332"
title: "Remove loop in Linked List"
slug: "remove-loop-in-linked-list"
difficulty: "Medium"
companyTags: ["VMWare", "Morgan Stanley", "Amazon", "Microsoft", "Snapdeal", "MakeMyTrip", "Oracle", "Walmart", "Goldman Sachs", "Adobe", "Qualcomm", "Kuliza", "Netskope"]
tags: ["Linked List", "two-pointer-algorithm", "Data Structures", "Algorithms"]
---

**Remove Loop in Linked List**
================================

## Summary
Given a linked list, remove the loop if it exists. The linked list can contain multiple nodes with duplicate values and the loop can start from any node.

This problem is about manipulating a linked list to detect and remove a loop that might be present in the list. The key concepts involved are traversing the linked list and using two pointers technique to detect the loop.

## Detailed Explanation
The approach to solve this problem involves two-pointer technique, where we move one pointer faster than the other. If there is no loop, these two pointers will eventually meet at some node. However, if there is a loop, they will meet at some node within the loop. Once we detect the meeting point, we reset one of the pointers to the starting point and then move both pointers at the same speed. The meeting point of these two pointers would be the start of the loop.

Here's the step-by-step breakdown:

1. Initialize two pointers `slow` and `fast` to the head of the linked list.
2. Move the `fast` pointer one step at a time, while moving the `slow` pointer one step at a time.
3. If there is no loop, `fast` will eventually meet `slow`.
4. If there is a loop, `fast` and `slow` will meet within the loop.
5. Reset `slow` to the starting point and move both `slow` and `fast` one step at a time.
6. The meeting point of these two pointers would be the start of the loop.

Time complexity: O(n), where n is the number of nodes in the linked list.
Space complexity: O(1).

## Optimized Solutions

### Java
```java
public ListNode detectAndRemoveLoop(ListNode head) {
    if (head == null || head.next == null) {
        return head;
    }

    ListNode slow = head, fast = head;

    while (fast != null && fast.next != null) {
        slow = slow.next;
        fast = fast.next.next;

        if (slow == fast) {
            break;
        }
    }

    if (fast == null || fast.next == null) {
        return head;
    }

    slow = head;
    while (slow.next != fast) {
        slow = slow.next;
        fast = fast.next;
    }

    slow.next = null;

    return head;
}
```

### Python
```python
def detect_and_remove_loop(head):
    if not head or not head.next:
        return head

    slow = head
    fast = head

    while fast and fast.next:
        slow = slow.next
        fast = fast.next.next

        if slow == fast:
            break

    if not fast or not fast.next:
        return head

    slow = head
    while slow.next != fast:
        slow = slow.next
        fast = fast.next

    slow.next = None

    return head
```

### C++
```cpp
ListNode* detectAndRemoveLoop(ListNode* head) {
    if (head == nullptr || head->next == nullptr) {
        return head;
    }

    ListNode* slow = head, *fast = head;

    while (fast != nullptr && fast->next != nullptr) {
        slow = slow->next;
        fast = fast->next->next;

        if (slow == fast) {
            break;
        }
    }

    if (fast == nullptr || fast->next == nullptr) {
        return head;
    }

    slow = head;
    while (slow->next != fast) {
        slow = slow->next;
        fast = fast->next;
    }

    slow->next = nullptr;

    return head;
}
```

### JavaScript
```javascript
function detectAndRemoveLoop(head) {
  if (!head || !head.next) {
    return head;
  }

  let slow = head, fast = head;

  while (fast && fast.next) {
    slow = slow.next;
    fast = fast.next.next;

    if (slow === fast) {
      break;
    }
  }

  if (!fast || !fast.next) {
    return head;
  }

  slow = head;
  while (slow.next !== fast) {
    slow = slow.next;
    fast = fast.next;
  }

  slow.next = null;

  return head;
}
```