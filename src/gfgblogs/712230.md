---
id: "712230"
title: "Prime Factorization using Sieve"
slug: "prime-factorization-using-sieve"
difficulty: "Medium"
companyTags: []
tags: []
---

**Prime Factorization using Sieve**
===============================

### Summary

Given a number `n`, find its prime factors. This problem involves understanding how to efficiently identify and extract prime numbers, which is crucial in various algorithms such as RSA encryption. We'll use the sieve of Eratosthenes algorithm to solve this problem.

### Detailed Explanation

The sieve of Eratosthenes algorithm works by iteratively marking the multiples of each prime number starting from 2. The left over numbers are prime numbers themselves. Here's a step-by-step breakdown:

1. Create an array `isPrime` of size `n+1`, initialized with all values set to `true`. This represents whether a number is prime or not.
2. Iterate through the array, starting from the second element (index 1). For each element at index `i`, if it's still marked as `true` (i.e., it's a prime number), mark its multiples as `false`.
3. Once the iteration is complete, iterate through the array again and find all elements that are still marked as `true`. These are the prime numbers.
4. For each prime number, find its factors by iterating from 2 to the square root of the prime number. If a factor is found, add it to the list of factors for the prime number.

Time complexity: O(n log log n)
Space complexity: O(n)

### Optimized Solutions

#### Java
```java
public class PrimeFactorization {
    public static List<Integer> sieveOfEratosthenes(int n) {
        boolean[] isPrime = new boolean[n + 1];
        for (int i = 2; i <= Math.sqrt(n); i++) {
            if (isPrime[i]) {
                for (int j = i * i; j <= n; j += i) {
                    isPrime[j] = false;
                }
            }
        }
        List<Integer> primeFactors = new ArrayList<>();
        for (int i = 2; i <= n; i++) {
            if (isPrime[i]) {
                int factors = 0;
                for (int j = 2; Math.pow(j, 2) <= i; j++) {
                    if (i % j == 0) {
                        factors++;
                    }
                }
                primeFactors.add(factors);
            }
        }
        return primeFactors;
    }
}
```

#### Python
```python
def sieve_of_eratosthenes(n):
    is_prime = [True] * (n + 1)
    for i in range(2, int(n ** 0.5) + 1):
        if is_prime[i]:
            for j in range(i * i, n + 1, i):
                is_prime[j] = False
    prime_factors = []
    for i in range(2, n + 1):
        if is_prime[i]:
            factors = 0
            for j in range(2, int(i ** 0.5) + 1):
                if i % j == 0:
                    factors += 1
            prime_factors.append(factors)
    return prime_factors

print(sieve_of_eratosthenes(100))
```

#### C++
```cpp
#include <vector>
using namespace std;

vector<int> sieveOfEratosthenes(int n) {
    vector<bool> isPrime(n + 1, true);
    for (int i = 2; i <= sqrt(n); i++) {
        if (isPrime[i]) {
            for (int j = i * i; j <= n; j += i) {
                isPrime[j] = false;
            }
        }
    }
    vector<int> primeFactors;
    for (int i = 2; i <= n; i++) {
        if (isPrime[i]) {
            int factors = 0;
            for (int j = 2; j * j <= i; j++) {
                if (i % j == 0) {
                    factors++;
                }
            }
            primeFactors.push_back(factors);
        }
    }
    return primeFactors;
}
```

#### JavaScript
```javascript
function sieveOfEratosthenes(n) {
    let isPrime = new Array(n + 1).fill(true);
    for (let i = 2; i <= Math.sqrt(n); i++) {
        if (isPrime[i]) {
            for (let j = i * i; j <= n; j += i) {
                isPrime[j] = false;
            }
        }
    }
    let primeFactors = [];
    for (let i = 2; i <= n; i++) {
        if (isPrime[i]) {
            let factors = 0;
            for (let j = 2; Math.pow(j, 2) <= i; j++) {
                if (i % j == 0) {
                    factors++;
                }
            }
            primeFactors.push(factors);
        }
    }
    return primeFactors;
}

console.log(sieveOfEratosthenes(100));
```